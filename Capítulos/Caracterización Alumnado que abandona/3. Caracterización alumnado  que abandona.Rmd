---
title: "3. Caracterizaci贸n del alumnado que abandona"
author: "Pablo Parrilla Ca帽adas"
date: "2025-04-29"
output: html_document
---

```{r}
library(dplyr)
library(ggplot2)
library(reshape2)
library(gridExtra)
library(skimr)
library(RColorBrewer)
library(scales)
library(corrplot)
library(reshape2)
library(lsr)
library(vcd)
library(rcompanion)
library(caret)
library(factoextra)
library(lubridate)
library(tidyr)
library(forcats)
library(FactoMineR)
library(rcompanion)
library(DescTools)
library(vegan)
library(fastDummies)
library(stringr)
library(forcats)
library(DescTools)

load("../../Datos/Cap铆tulos/Preprocesado.RData")
```

# Contextualizaci贸n

```{r}
table(abandono$mes)
```


```{r fig.width=8}

abandono_date <- abandono %>%
  mutate(baja_fecha = as.Date(baja_fecha))
# Agrupar por fecha y contar las bajas
abandono_acumulado <- abandono_date[abandono_date$mes=="septiembre",] %>%
  count(baja_fecha) %>%
  arrange(baja_fecha) %>%
  mutate(acumulado = cumsum(n))  # Suma acumulada

# Crear la gr谩fica
a=ggplot(abandono_acumulado, aes(x = baja_fecha, y = acumulado)) +
  geom_line(color = "black", size = 1) + 
  geom_point(color = "red", size = 3) + 
   scale_x_date(date_breaks = "2 days", date_labels = "%d-%m") + 
   geom_text(aes(label = acumulado), vjust = -1, hjust= 1, color = "black", size = 3) +
  labs(title = "Bajas Acumuladas por d铆a de septiembre",
       x = "Fecha",
       y = "Total Acumulado") +
  theme_minimal()+
   theme(axis.text.x = element_text(angle = 45, hjust = 1))

abandono_acumulado <- abandono_date[abandono_date$mes=="julio",] %>%
  count(baja_fecha) %>%
  arrange(baja_fecha) %>%
  mutate(acumulado = cumsum(n))  # Suma acumulada

# Crear la gr谩fica
b=ggplot(abandono_acumulado, aes(x = baja_fecha, y = acumulado)) +
  geom_line(color = "black", size = 1) + 
  geom_point(color = "red", size = 3) + 
   scale_x_date(date_breaks = "2 days", date_labels = "%d-%m", position = ) + 
   geom_text(aes(label = acumulado), vjust = -1, hjust=0.75, color = "black", size = 3) +
  labs(title = "Bajas Acumuladas por d铆a de julio",
       x = "Fecha",
       y = "Total Acumulado") +
  theme_minimal()+
   theme(axis.text.x = element_text(angle = 45, hjust = 1))

grid.arrange(b,a,ncol=2)

```


```{r}
total_abandonadas <- sum(abandono$asi_left, na.rm = TRUE)

# Calcular la media de asi_left por mes y el porcentaje del total
media_abandono_por_mes <- abandono %>%
  group_by(mes) %>%
  summarise(
    media_asi_left = mean(asi_left, na.rm = TRUE),
    porcentaje = (sum(asi_left, na.rm = TRUE) / total_abandonadas) * 100
  ) %>% arrange(desc(porcentaje))
  

# Mostrar resultado
print(media_abandono_por_mes)

mean(abandono$asi_left)

```

# Influencia sociodemogr谩fica

```{r}

vars_usar <- c("nacionalitat", "data_nac", "sexe", "alta_universitat", "prov_origen",
               "anyo_ingreso", "tipo_ingreso", "nota10", "nota14", "estudios_p", "estudios_m",
               "dedicacion", "desplazado", "discapacidad", "becado", "preferencia_seleccion", "abandono")

# Subset del dataset
df_sel <- sociodemografia[, vars_usar]

df_sel$abandono=as.factor(df_sel$abandono)

#  TRANSFORMACIONES MANUALES

# Asegura que 'abandono' es num茅rica binaria
df_sel$abandono <- as.numeric(as.character(df_sel$abandono))

# Separar variables num茅ricas y categ贸ricas
num_vars <- vars_usar[sapply(df_sel[, vars_usar], is.numeric)]
cat_vars <- vars_usar[sapply(df_sel[, vars_usar], function(x) is.character(x) || is.factor(x))]

# Inicializar resultados
resultados <- data.frame(variable = character(),
                         correlacion = numeric(),
                         tipo = character(),
                         stringsAsFactors = FALSE)

#  Correlaciones num茅ricas (Pearson)
for (var in num_vars) {
  if (var != "abandono") {
    valor <- suppressWarnings(cor(df_sel$abandono, df_sel[[var]], use = "complete.obs"))
    resultados <- rbind(resultados, data.frame(variable = var, correlacion = valor, tipo = "Num茅rica"))
  }
}

# Correlaciones categ贸ricas (Cram茅rs V corregido)
for (var in cat_vars) {
  x <- as.factor(df_sel$abandono)
  y <- as.factor(df_sel[[var]])
  
  df_temp <- data.frame(x = x, y = y)
  df_temp <- df_temp[complete.cases(df_temp), ]
  
  # Verifica niveles 煤tiles
  if (nlevels(df_temp$x) >= 2 && nlevels(df_temp$y) >= 2) {
    # Agrupar niveles infrecuentes directamente en el data.frame
    df_temp$y <- fct_lump_min(df_temp$y, min = 2)
    df_temp$y <- droplevels(df_temp$y)
    
    # Tabla cruzada corregida
    v <- DescTools::CramerV(table(df_temp$x, df_temp$y), bias.correct = TRUE)
    
    resultados <- rbind(resultados, data.frame(variable = var, correlacion = v, tipo = "Categ贸rica"))
  }
}


resultados

#  Gr谩fico
ggplot(resultados, aes(x = reorder(variable, correlacion), y = correlacion, fill = tipo)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  scale_fill_manual(values = c("Num茅rica" = "steelblue", "Categ贸rica" = "orange")) +
  theme_minimal() +
  labs(title = "Correlaci贸n de variables sociodemogr谩ficas con 'abandono'",
       x = "Variable",
       y = "Correlaci贸n (Pearson o Cram茅r's V)",
       fill = "Tipo de variable")


```



```{r}
table(sociodemografia$preferencia_seleccion, sociodemografia$abandono)
```

```{r}
table(sociodemografia$becado,sociodemografia$abandono)
```


```{r fig.width=10,fig.height=5}

# Convierte el data frame a formato largo (long)
df_long <- sociodemografia[sociodemografia$abandono==1,] %>%
  pivot_longer(cols = c(anyo_ingreso, alta_universitat,data_nac), names_to = "variable", values_to = "valor")

ggplot(df_long, aes(x = variable,y=valor, fill = variable)) +
  geom_boxplot(alpha = 0.5) +
  labs(title = "Boxplot de anyo_ingreso, alta_universitat y \ndata_nac", x = "Valor", y = "Densidad") +
  theme_minimal()


```


```{r}
multi_vars <- c("tipo_ingreso", "preferencia_seleccion","becado", "estudios_p", "estudios_m")

# Crear lista de plots individuales ordenados por frecuencia
plots_multi <- lapply(multi_vars, function(var) {
  ggplot(sociodemografia[sociodemografia$abandono==1,], aes(x = fct_infreq(.data[[var]]), fill = .data[[var]])) +
    geom_bar() +
    scale_fill_discrete() +
    labs(title = var, x = NULL, y = "Frecuencia") +
    theme_minimal() +
    theme(legend.position = "none", axis.text.x = element_text(angle = 45, hjust = 1))
})

# Mostrar en grid de 2x2
grid.arrange(grobs = plots_multi, ncol = 3)
```

```{r fig.height=8, fig.width=10}
# Grupos de variables
binarias_1 <- c("nacionalitat", "sexe")
binarias_3 <- c("prov_origen", "desplazado")
binarias_2 <- c("discapacidad","dedicacion" )

# Funci贸n que crea un gr谩fico para un grupo de variables
crear_plot_binarias <- function(vars) {
  df <- sociodemografia[sociodemografia$abandono==1,] %>%
    select(all_of(vars)) %>%
    pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valor") %>%
    filter(!is.na(Valor)) %>%
    group_by(Variable, Valor) %>%
    summarise(n = n(), .groups = "drop") %>%
    group_by(Variable) %>%
    mutate(Proporcion = n / sum(n),
           Etiqueta = paste0(Valor, ": ", round(Proporcion * 100), "%"))
  
  ggplot(df, aes(x = Variable, y = Proporcion, fill = Valor)) +
    geom_col(position = position_dodge(width = 0.9)) +
    geom_text(aes(label = Etiqueta), position = position_dodge(width = 0.9),
              vjust = -0.3, size = 3) +
    scale_y_continuous(labels = scales::percent_format(accuracy = 1),
                       breaks = seq(0, 1, 0.1), limits = c(0, 1.05)) +
    labs(title = paste("Variables:", paste(vars, collapse = ", ")),
         y = "Proporci贸n", x = NULL) +
    theme_minimal() +
    theme(legend.position = "none",
          axis.text.x = element_text(angle = 45, hjust = 1))
}

# Crear los gr谩ficos
plot1 <- crear_plot_binarias(binarias_1)
plot2 <- crear_plot_binarias(binarias_2)
plot3 <- crear_plot_binarias(binarias_3)

# Mostrar todos en un grid
grid.arrange(plot1, plot2, plot3, nrow = 3)
```

```{r}

# Sup贸n que df_sel es tu dataset con abandono
# Variables que te interesan
vars <- c("nacionalitat", "data_nac", "alta_universitat", "prov_origen",
               "anyo_ingreso", "tipo_ingreso",
               "dedicacion", "desplazado", "becado", "preferencia_seleccion", "abandono")

# 1. Subset y quita NA
df_model <- sociodemografia[, c("abandono", vars)] %>% na.omit()

# 2. One-hot encoding para categ贸ricas
df_encoded <- dummy_cols(df_model, select_columns = c("tipo_ingreso","dedicacion", "desplazado", "becado", "preferencia_seleccion"),
                         remove_selected_columns = TRUE, remove_first_dummy = FALSE)

# 3. Calcular matriz de distancia
dist_mat <- dist(df_encoded %>% select(-abandono), method = "euclidean")

# 4. PERMANOVA
a=adonis2(dist_mat ~ abandono, data = df_encoded, permutations = 999)
a
```


# Acad茅micas

```{r}
vars_usar <- colnames(academicas[2:44])


# Subset del dataset
df_sel <- academicas[, vars_usar]

df_sel$abandono=as.factor(df_sel$abandono)

#  TRANSFORMACIONES MANUALES

# Asegura que 'abandono' es num茅rica binaria
df_sel$abandono <- as.numeric(as.character(df_sel$abandono))

# Separar variables num茅ricas y categ贸ricas
num_vars <- vars_usar[sapply(df_sel[, vars_usar], is.numeric)]
cat_vars <- vars_usar[sapply(df_sel[, vars_usar], function(x) is.character(x) || is.factor(x))]

# Inicializar resultados
resultados <- data.frame(variable = character(),
                         correlacion = numeric(),
                         tipo = character(),
                         stringsAsFactors = FALSE)

#  Correlaciones num茅ricas (Pearson)
for (var in num_vars) {
  if (var != "abandono") {
    valor <- suppressWarnings(cor(df_sel$abandono, df_sel[[var]], use = "complete.obs"))
    resultados <- rbind(resultados, data.frame(variable = var, correlacion = valor, tipo = "Num茅rica"))
  }
}

# Correlaciones categ贸ricas (Cram茅rs V corregido)
for (var in cat_vars) {
  x <- as.factor(df_sel$abandono)
  y <- as.factor(df_sel[[var]])
  
  df_temp <- data.frame(x = x, y = y)
  df_temp <- df_temp[complete.cases(df_temp), ]
  
  # Verifica niveles 煤tiles
  if (nlevels(df_temp$x) >= 2 && nlevels(df_temp$y) >= 2) {
    # Agrupar niveles infrecuentes directamente en el data.frame
    df_temp$y <- fct_lump_min(df_temp$y, min = 2)
    df_temp$y <- droplevels(df_temp$y)
    
    # Tabla cruzada corregida
    v <- DescTools::CramerV(table(df_temp$x, df_temp$y), bias.correct = TRUE)
    
    resultados <- rbind(resultados, data.frame(variable = var, correlacion = v, tipo = "Categ贸rica"))
  }
}


resultados

#  Gr谩fico
ggplot(resultados, aes(x = reorder(variable, correlacion), y = correlacion, fill = tipo)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  scale_fill_manual(values = c("Num茅rica" = "steelblue", "Categ贸rica" = "orange")) +
  theme_minimal() +
  theme(axis.text.y=element_text(size = 6))+
  labs(title = "Correlaci贸n de variables acad茅micas con 'abandono'",
       x = "Variable",
       y = "Correlaci贸n (Pearson o Cram茅r's V)",
       fill = "Tipo de variable")


```

```{r}
table(academicas$curso_mas_bajo,academicas$curso_mas_alto,academicas$abandono)
```

```{r}
grupo_creditos_altos <- c( "cred_sup_tit", "cred_mat_normal", "cred_mat_total")

grupo_creditos_moderados <- c( "cred_ptes_acta", "cred_sup_1o", "cred_sup_2o", "cred_sup_3o","cred_sup_4o")

grupo_creditos_individuales <- c("cred_mat1", "cred_mat2", "cred_mat3", "cred_mat4", "cred_mat_sem_a",  "cred_mat_sem_b", "cred_mat_anu")

grupo_creditos_especiales <- c("cred_sup", "cred_sup_espec", "cred_sup_normal", "cred_sup_sem_a", "cred_sup_sem_b", "cred_sup_total", "cred_mat_movilidad", "cred_mat_practicas")

grupo_otros_academicos <- c("practicas", "pract1", "asig1", "activ1", "actividades", "ajuste", "total1")

rendimientos <- c("rendimiento_cuat_a", "rendimiento_total", "rend_total_ultimo", "rend_total_penultimo","rend_total_antepenultimo")



# Transformar a formato largo para ggplot
df_long <- academicas[academicas$abandono==1,] %>%
  select(all_of(grupo_creditos_altos)) %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valor")

conteos <- df_long %>%
  filter(!is.na(Valor)) %>%
  group_by(Variable) %>%
  summarise(n = n())

# Crear gr谩fico con etiquetas de conteo
ggplot(df_long, aes(x = Valor, y = fct_reorder(Variable, -Valor, .fun = median, na.rm = TRUE))) +
  geom_boxplot(fill = "skyblue", outlier.size = 0.7) +
  geom_text(data = conteos, aes(x = Inf, y = fct_reorder(Variable, -n), label = paste0("n = ", n)),
            hjust = 2,  size = 3.5, inherit.aes = FALSE,vjust = 1.5) +
  labs(title = "Distribuci贸n de cr茅ditos totales de personas ", x = "Valor", y = "Variable") +
  theme_minimal(base_size = 12)
```

```{r}

# Transformar a formato largo para ggplot
df_long <- academicas[academicas$abandono==1,] %>%
  select(all_of(grupo_creditos_moderados)) 
  
df_long[df_long==0]=NA

df_long=df_long%>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valor")

conteos <- df_long %>%
  filter(!is.na(Valor)) %>%
  group_by(Variable) %>%
  summarise(n = n())

# Crear gr谩fico con etiquetas de conteo
ggplot(df_long, aes(x = Valor, y = fct_reorder(Variable, -Valor, .fun = median, na.rm = TRUE))) +
  geom_boxplot(fill = "skyblue", outlier.size = 0.7) +
  geom_text(data = conteos, aes(x = Inf, y = fct_reorder(Variable, -n), label = paste0("n = ", n)),
            hjust = 3,  size = 3.5, inherit.aes = FALSE,vjust = 1.5) +
  labs(title = "Cr茅ditos superados y pedientes", x = "Valor", y = "Variable") +
  theme_minimal(base_size = 12)

```


```{r}
# Transformar a formato largo para ggplot
df_long <- academicas[academicas$abandono==1,] %>%
  select(all_of(grupo_creditos_individuales)) 

df_long[df_long==0]=NA

df_long=df_long%>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valor")

conteos <- df_long %>%
  filter(!is.na(Valor)) %>%
  group_by(Variable) %>%
  summarise(n = n())

# Crear gr谩fico con etiquetas de conteo
ggplot(df_long, aes(x = Valor, y = fct_reorder(Variable, -Valor, .fun = median, na.rm = TRUE))) +
  geom_boxplot(fill = "skyblue", outlier.size = 0.7) +
  geom_text(data = conteos, aes(x = Inf, y = fct_reorder(Variable, -n), label = paste0("n = ", n)),
            hjust = 3,  size = 3.5, inherit.aes = FALSE,vjust = 1.5) +
  labs(title = "Cr茅ditos matriculados por a帽o y semestre", x = "Valor", y = "Variable") +
  theme_minimal(base_size = 12)

```

```{r}
vars <- c( "curso_mas_bajo", "curso_mas_alto", "cred_mat1",
  "cred_mat2", "cred_mat3", "cred_mat4", "cred_sup_normal",
  "cred_sup_espec", "cred_sup", "cred_mat_normal", "cred_mat_movilidad",
  "cred_ptes_acta", "cred_mat_practicas", "cred_mat_sem_a", "cred_mat_sem_b",
  "cred_mat_anu", "cred_mat_total", "cred_sup_sem_a", "cred_sup_sem_b",
  "cred_sup_total", "rendimiento_cuat_a", "rendimiento_total", "exento_npp",
  "anyo_inicio_estudios",  "cred_sup_1o",
  "cred_sup_2o", "cred_sup_3o", "cred_sup_4o", "practicas",
  "actividades", "ajuste", "cred_sup_tit", "asig1",
  "pract1", "activ1", "total1", "rend_total_ultimo",
  "rend_total_penultimo", "rend_total_antepenultimo"
)

# 1. Subset y quita NA
df_model <- academicas[, c("abandono", vars)]

# 2. One-hot encoding para categ贸ricas

# 3. Calcular matriz de distancia
dist_mat <- dist(df_model %>% select(-abandono), method = "euclidean")

# 4. PERMANOVA
a=adonis2(dist_mat ~ abandono, data = df_model, permutations = 999)
a
```


# Digital

```{r fig.height=6}


vars_usar <- colnames(poliformat[2:69])

# Subset del dataset
df_sel <- poliformat[, vars_usar]
df_sel$abandono <- as.numeric(as.character(poliformat$abandono))

# Separar variables num茅ricas y categ贸ricas
num_vars <- vars_usar[sapply(df_sel[, vars_usar], is.numeric)]
cat_vars <- vars_usar[sapply(df_sel[, vars_usar], function(x) is.character(x) || is.factor(x))]

# Inicializar resultados
resultados <- data.frame(variable = character(),
                         correlacion = numeric(),
                         tipo = character(),
                         mes = character(),
                         stringsAsFactors = FALSE)

extraer_mes <- function(nombre) {
  # Caso 1: termina en _est
  if (str_detect(nombre, "_\\d{1,2}_est$")) {
    return(str_extract(nombre, "\\d{1,2}(?=_est$)"))
  }
  # Caso 2: empieza con n_wifi_days y termina con un n煤mero
  if (str_detect(nombre, "^n_wifi_days_2024_\\d{1,2}$")) {
    return(str_extract(nombre, "\\d{1,2}$"))
  }
  
  if (str_detect(nombre, "^n_wifi_days_2025_\\d{1,2}$")) {
    return(str_extract(nombre, "\\d{1,2}$"))
  }
  # Caso 3: termina en _media
  if (str_ends(nombre, "_media")) {
    return("Media")
  }
  return("Desconocido")
}
#  Correlaciones num茅ricas
for (var in num_vars) {
  if (var != "abandono") {
    valor <- suppressWarnings(cor(df_sel$abandono, df_sel[[var]], use = "complete.obs"))
    mes <- extraer_mes(var)
    resultados <- rbind(resultados, data.frame(variable = var, correlacion = valor, tipo = "Num茅rica", mes = mes))
  }
}

#  Categ贸ricas
for (var in cat_vars) {
  x <- as.factor(df_sel$abandono)
  y <- as.factor(df_sel[[var]])
  
  df_temp <- data.frame(x = x, y = y) %>% na.omit()
  
  if (nlevels(df_temp$x) >= 2 && nlevels(df_temp$y) >= 2) {
    df_temp$y <- fct_lump_min(df_temp$y, min = 2) %>% droplevels()
    v <- DescTools::CramerV(table(df_temp$x, df_temp$y), bias.correct = TRUE)
    mes <- extraer_mes(var)
    resultados <- rbind(resultados, data.frame(variable = var, correlacion = v, tipo = "Categ贸rica", mes = mes))
  }
}

# Define el orden manual de niveles
niveles_ordenados <- c("7", "8", "9", "10", "11", "12", "1", "Media")

# Convertir la columna 'mes' en factor con ese orden
resultados$mes <- factor(resultados$mes, levels = niveles_ordenados)

# Paleta de colores manual
colores_meses <- c(
  "7" = "#F8766D", "8" = "#D89000", "9" = "#A3A500", 
  "10" = "#39B600", "11" = "#00BF7D", "12" = "#00BFC4", 
  "1" = "#619CFF", "Media" = "#BDBDBD"  # gris claro o azul tenue
)

# Gr谩fico actualizado
ggplot(resultados, aes(x = reorder(variable, correlacion), y = correlacion, fill = mes)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  theme_minimal() +
  labs(title = "Correlaci贸n de variables digitales con 'abandono'",
       x = "Variable",
       y = "Correlaci贸n (Pearson o Cram茅r's V)",
       fill = "Mes") +
  scale_fill_manual(values = colores_meses, drop = FALSE) +
  theme(axis.text.y = element_text(size = 6))

```

```{r}
lineas_multiple=poliformat_enterolineas_multiple <- function(df, columnas, titulo) {
  # Verificar si la columna "abandono" existe
  if (!"abandono" %in% names(df)) {
    stop("La columna 'abandono' no existe en el dataframe.")
  }

  # Convertir columnas num茅ricas a nombres si hace falta
  if (is.numeric(columnas)) {
    columnas <- names(df)[columnas]
  }

  # Reemplazar NA por 0
  df$abandono <- ifelse(is.na(df$abandono), 0, df$abandono)

  # Seleccionar columnas
  df_seleccionado <- df[, c(columnas, "abandono"), drop = FALSE]
  df_seleccionado <- df_seleccionado[sapply(df_seleccionado, is.numeric)]

  df_valores <- df_seleccionado[, setdiff(names(df_seleccionado), "abandono"), drop = FALSE]
  if (ncol(df_valores) == 0) {
    message("No hay columnas num茅ricas en la selecci贸n.")
    return(NULL)
  }

  df_valores$ID <- 1:nrow(df_valores)
  df_valores$abandono <- df_seleccionado$abandono

  df_melt <- reshape2::melt(df_valores, id.vars = c("ID", "abandono"),
                            variable.name = "Variable", value.name = "Valor")
  
  df_melt$Variable <- factor(df_melt$Variable, levels = columnas)

  df_negro <- df_melt[df_melt$abandono == 0, ]
  df_rojo  <- df_melt[df_melt$abandono == 1, ]
  
  df_rojo=unique(df_rojo)
  df_negro=unique(df_negro)

  ggplot() +
    geom_line(data = df_negro, aes(x = Variable, y = Valor, group = ID),
              color = "black", alpha = 0.3, size = 0.5) +
    geom_line(data = df_rojo, aes(x = Variable, y = Valor, group = ID),
              color = "red", alpha = 0.8, size = 0.7) +
    labs(title =  titulo,
         x = "Variables (Columnas)", y = "Valores") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1),
          panel.grid.minor = element_blank())
}

g1 <- lineas_multiple(poliformat, c(2:8), "Comparaci贸n: \nEventos de Poliformat")
g2 <- lineas_multiple(poliformat, c(9:15), "Comparaci贸n: \nD铆as con Sesiones iniciadas")
g3 <- lineas_multiple(poliformat, c(16:22), "Comparaci贸n: \nVisitas a asignaturas")
g4 <- lineas_multiple(poliformat, c(23:29), "Comparaci贸n: \nMinutos Totales")
g5 <- lineas_multiple(poliformat, c(38:43), "Comparaci贸n: \nD铆as accedidos a Recursos \nde una asignatura")
g6 <- lineas_multiple(poliformat, c(44:50), "Comparaci贸n: \nAcciones en recursos \n de una asignatura")
g7 <- lineas_multiple(poliformat, c(51:55), "Comparaci贸n: \nTareas entregadas en \nuna asignatura")
g8 <- lineas_multiple(poliformat, c(56:60), "Comparaci贸n: \nTests entregados en \nuna asignatura")


grid_1 <- grid.arrange(g1, g2, ncol = 2)
grid_2 <- grid.arrange(g3, g4, ncol = 2)
grid_3 <- grid.arrange(g5, g6, ncol = 2)
grid_4 <- grid.arrange(g7, g8, ncol = 2)
```

```{r}
lineas_multiple(poliformat, c(56:60), "Comparaci贸n: \nConexiones al wifi")
```

